from Bio import Entrez
import time

def search_pubmed(author, start_year, end_year):
    # Set your email here
    Entrez.email = "araz.rawshani@gu.se"

    # Define search query with date range
    #query = f'"{author}"[Author] AND ("{start_year}/01/01"[Date - Publication] : "{end_year}/12/31"[Date - Publication])'
    query = f'"{author}"[Author]'

    # Perform the search
    handle = Entrez.esearch(db="pubmed", term=query, retmax=500)
    record = Entrez.read(handle)
    handle.close()

    # Get the list of PMIDs
    pmids = record["IdList"]

    # Introduce a delay of 1 second
    #time.sleep(1)

    return pmids

# Sven-Erik: 
#ABRAHAMSSON Kate: 37559149, 37249409, 36635161, 35725462, 35597964, 34390033, 33676542, 33274398, 33027836, 32800709, 32511799, 32146062, 31420891, 30822811, 30725391, 30261518, 30221367, 29738345, 29273218, 26667982, 26522897, 26087380, 25643247, 25560247, 25302538, 24571649, 23769200, 23220244, 22521622, 21419706, 20630805, 19140089, 19031268, 18947626, 17469030, 17162083, 16978285
#HADJIKHANI Nouchine: 38081435, 38078961, 37777792, 37732542, 37605367, 37431388, 37209610, 37099200, 37052647, 36317253, 35980452, 35650524, 35249132, 35217580, 35181440, 35148650, 35081902, 34998084, 34626753, 34390517, 34312812, 34115279, 33924855, 33907992, 33773610, 33767300, 33751423, 33661163, 33604906, 33385505, 33280150, 32945591, 32496594, 32239542, 31843035, 31740723, 31494251, 31362564, 30943894, 30918090, 30828832, 30549144, 30444671, 30168869, 29984154, 29855596, 29778275, 29683406, 29620428, 29483603, 29214437, 29044580, 28905267, 28881454, 28600558, 28541256, 28402536, 28060919, 27891819, 27521844, 27163722, 27095660, 26918704, 26912096, 26742926, 26496498, 25882051, 25798103, 25244532, 25162783, 24694721, 24554162, 24528893, 24493851, 24343334, 24324679, 24307288, 24179786, 24095647, 24039712, 23720503, 23450507, 23342130, 23028494, 22722626, 22270846, 24179736, 22162064, 21912594, 21666261, 21346644, 21209411, 20019073, 20018455, 19340289, 19337363, 19218867, 19151375, 18954477, 18946504, 18695522, 18586370, 18550622, 18345963, 18025393, 17578530, 17534902, 17435592, 17133386, 17048979, 16603916, 16306324, 15546983, 15355006, 15219586, 15076750, 14680638, 14561892, 12112771
#DAHLGREN Jovanna: 37740541, 37410401, 37386396, 37296018, 37042982, 36848922, 36669261, 36635911, 36195523, 36071648, 36070291, 35972993, 35407641, 35263756, 35263750, 34939937, 34858328, 34736266, 34647329, 34407253, 34289182, 34098245, 34045667, 34014174, 33876865, 33794185, 33440388, 33325092, 33258387, 33148198, 33079376, 32637723, 32559323, 32479603, 32352647, 32064658, 32037650, 31978372, 31920957, 31627342, 31371184, 31004397, 30895831, 30742901, 30622515, 30511422, 30497848, 30339244, 30328152, 30287892, 30264628, 30192410, 30081018, 30071142, 30025301, 29894754, 29869117, 29746881, 29499615, 29210112, 29110521, 28753183, 28100483, 28065734, 27874270, 27229351, 27400741, 27134198, 26918292, 26631057, 26467218, 26308884, 26227556, 26044035, 26010319, 25974306, 25647116, 25357024, 24606072, 24491362, 24483154, 24237634, 24117667, 24028671, 23784906, 23469944, 23116291, 22577752, 22523671, 22516981, 22417085, 22363887, 21912154, 21912170, 21912164, 21767302, 21551165, 21430029, 21352359, 21304250, 20876176, 20575078, 20455890, 20029237, 19604174, 19138407, 19077222, 19001519, 18452378, 18370761, 18076760, 17998795, 16864694, 16203673, 15953522, 15585685, 15284195, 15128920, 14754975, 14630755, 14557458, 12511011
#DARIN Niklas: 37272928, 37248298, 36935417, 36305855, 35527992, 35403730, 35233790, 34873726, 34872991, 34806237, 34662929, 34098245, 33938619, 33579567, 33217308, 32949115, 32857451, 32637636, 32391929, 32157189, 31898846, 31762738, 31741821, 31276219, 31174102, 30711365, 30642739, 30574118, 30004022, 29920680, 29483667, 29205472, 29101127, 28981487, 28856750, 28676060, 28624465, 28561207, 28546572, 28187749, 28101805, 27992417, 27912044, 27604842, 27536225, 27485408, 27234010, 27206786, 26893257, 26657515, 26475597, 26090827, 25642805, 25629079, 25615419, 25325473, 25274184, 24731534, 24524299, 24084573, 23827424, 23623855, 23486871, 23026858, 22781096, 22237560, 21820356, 21428760, 19567699, 19194956, 19154529, 19138848, 19097920, 18243024, 18055683, 17376748, 17275669, 17049859, 16896309, 15907288, 15792869, 15741996, 15558317, 14991352, 14596686, 12359126, 11815765
#EKWALL Olov: 37390899, 36878420, 36754962, 36413155, 35864810, 35819358, 35747950, 35559672, 35164800, 35080750, 34449549, 33892926, 33890986, 33686667, 33574239, 32714327, 32111171, 31275320, 31027649, 30662440, 30508539, 30157810, 29853568, 29849176, 29454003, 29367624, 29069385, 28866385, 27870550, 27824109, 27397107, 26696640, 26257734, 25776846, 25627671, 25038256, 24947367, 24614117, 23844026, 22956912, 22796227, 22165183, 21210960, 19829122, 19653288, 19107747, 18322283, 18242955, 18213698, 17215373, 17129978, 15282984, 14764761
#HELLSTRÖM Ann: 37963901, 37841591, 37698061, 37671123, 37532738, 37496672, 37382945, 37169579, 37120902, 36943533, 36892137, 36717199, 36468823, 36424118, 36420952, 35922112, 35868524, 35793362, 35778901, 35681088, 35495419, 35405946, 35395120, 35318709, 35313264, 35250465, 35232892, 34832995, 34759238, 34648010, 34392310, 34376441, 34304244, 34218224, 33981857, 33980506, 33937726, 33895781, 33862236, 33797551, 33611321, 33547036, 33523106, 33224151, 33163463, 33099660, 33004691, 32847833, 32635612, 32612607, 32592272, 32588218, 32521072, 32330929, 32140799, 32114373, 32098361, 32094231, 32054022, 32043645, 31917679, 31756675, 31747093, 31697330, 31676594, 31593285, 31486227, 31474316, 31443723, 30920014, 30763437, 30646195, 30565323, 30543348, 30471715, 30297879, 30282834, 29729148, 29679529, 29649829, 29487115, 29444356, 29423508, 29281748, 29274846, 29180355, 29072164, 29068172, 28972955, 28969546, 28934640, 28872709, 28763559, 28601919, 28539804, 28515072, 28456063, 28399534, 28345241, 28199833, 27870826, 27650433, 27229351, 27720550, 27720395, 27631399, 27603537, 27552668, 27537414, 27417579, 27155572, 27088589, 27010699, 26969711, 26833743, 26372519, 26159370, 25925609, 25833984, 25825949, 25678632, 25330287, 25300950, 25044161, 24963022, 24568873, 24458713, 24447816, 24441105, 24310059, 24163910, 24148095, 24069180, 23985883, 23942554, 23887600, 23855971, 23782686, 23782559, 23719305, 23428885, 23307210, 23230805, 23166302, 23143441, 23095978, 22801831, 22491401, 22491391, 22468401, 21854449, 21726282, 21696987, 21517962, 21421650, 21320961, 21289247, 21263374, 21150442, 21063127, 21060045, 21056995, 20937998, 20484600, 20385939, 19924029, 19745089, 19433710, 19418686, 19416116, 19289449, 19190540, 19001522, 18997086, 18823297, 18811637, 18754826, 18662348, 18637047, 18494726, 17589522, 17567756, 17564937, 17453232, 17159030, 16978464, 16965493, 16740833, 16637832, 16637831, 16542519, 16020358, 15827004, 15695599, 15305531, 15128920, 14754975, 14595040, 12930904, 12859263, 12107259, 12032260, 11985286
#LAJIC NÄRESKOG Svetlana
#SWOLIN-EIDE Diana: 37468555, 35974161, 35960382, 35568603, 35490381, 34563763, 34283000, 33353965, 32696294, 31531762, 31421951, 30970375, 30071306, 30071142, 29992675, 28349558, 27307256, 26970731, 26772621, 28326354, 25613047, 24818653, 24441105, 23224949, 22103559, 19929273, 18976351, 18715809, 17627820, 17381473, 16932897, 14739369, 12208661, 30386193

author = "SWOLIN-EIDE, Diana"
start_year = 1990
end_year = 2023
pmids = search_pubmed(author, start_year, end_year)
print(author)
print(", ".join(pmids))